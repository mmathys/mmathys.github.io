!function t(e,r,a){function o(i,s){if(!r[i]){if(!e[i]){var d="function"==typeof require&&require;if(!s&&d)return d(i,!0);if(n)return n(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[i]={exports:{}};e[i][0].call(c.exports,function(t){var r=e[i][1][t];return o(r?r:t)},c,c.exports,t,e,r,a)}return r[i].exports}for(var n="function"==typeof require&&require,i=0;i<a.length;i++)o(a[i]);return o}({1:[function(t,e,r){var a=t("./range");e.exports.overflowX=function(t,e,r){var o=[];return o[0]=a.min(t,e.accessor),o[1]=a.max(t,e.accessor),o[1]=a.applyOverflow(o[0],o[1],r,e.data_type),o},e.exports.overflowY=function(t,e,r,o){var n=[];return n[0]=a.minMultipleSets(t,e,r),n[1]=a.maxMultipleSets(t,e,r),n[1]=a.applyOverflow(n[0],n[1],o,e[0].data_type),n}},{"./range":7}],2:[function(t,e,r){e.exports.row=function(t,e){for(var r=[],a=0;a<t.length;a++)"undefined"!=typeof t[a][e]&&r.push(t[a]);return r}},{}],3:[function(t,e,r){var a=(t("./sort"),t("./id"));e.exports.data_types=function(t,e){for(var r=0;r<t.length;r++)for(var a=0;a<e.length;a++)"Number"===e[a].data_type?t[r][e[a].row]=parseFloat(t[r][e[a].row]):"Date"===e[a].data_type&&(t[r][e[a].row]=d3.time.format(e[a].date_format).parse(t[r][e[a].row]));return t},e.exports.ids=function(t,e){for(var r=0;r<t.length;r++)for(var o=0;o<e.length;o++)"index"!==e[o].type&&(t[r][a.get(e[o])]=t[r][e[o].row],delete t[r][e[o].row]);return t}},{"./id":4,"./sort":8}],4:[function(t,e,r){e.exports.get=function(t){return t.row+"#"+t.url},e.exports.invert=function(t,e){for(var r=0;r<e.length;r++)if(t===e[r].rowId)return e[r]},e.exports.raw=function(t,e){return t+"#"+e}},{}],5:[function(t,e,r){function a(t,e){for(var r="",a="Weighted Price",o=0;o<t.length;o++){var n=e(t[o],a);r+=0!==o?"L"+n[0]+","+n[1]:"M"+n[0]+","+n[1],o!==t.length-1&&(r+=" ")}return r}var o=t("./filter");e.exports.mode="undefined",e.exports.addLine=function(t,r,o,n){var i=d3.select("#graph").append("path").attr("class","line").attr("style","stroke:"+o.color).attr("data-row",o.rowId);("linear"===e.exports.mode||"undefined"===e.exports.mode)&&i.attr("d",a(t,n.cord(r,o)))},e.exports.update=function(t,r,o,n){if("linear"===e.exports.mode||"undefined"===e.exports.mode)d3.select('.line[data-row="'+o.rowId+'"]').attr("d",a(t,n.cord(r,o)));else{var i=d3.svg.line().x(r.accessor_scaled).y(n.scaled(o)).interpolate(e.exports.mode);d3.select('.line[data-row="'+o.rowId+'"]').attr("d",i(t))}},e.exports.updateAll=function(t,r,a,n){for(var i=0;i<a.length;i++)e.exports.update(o.row(t,a[i].rowId),r,a[i],n)},e.exports.setActivated=function(t,e){var r=d3.selectAll(".data-point[data-row='"+e.rowId+"']"),a=d3.selectAll(".line[data-row='"+e.rowId+"']");a.classed("hidden",!t),e.activated=t,t?r.classed("hidden",!t):r.classed("hidden",!t)},e.exports.lineVisibility=function(t,e){for(var r=0;r<e.length;r++){console.log("line with visibility = ",e[r].activated,"@",e[r].rowId);var a=d3.selectAll('.line[data-row="'+e[r].rowId+'"]');a.classed("hidden",t?!e[r].activated:!0)}console.log(".")}},{"./filter":2}],6:[function(t,e,r){e.exports.visible=!1,e.exports.updateVisibility=function(t){for(var r=0;r<t.length;r++){var a=d3.selectAll('.data-point[data-row="'+t[r].rowId+'"]');e.exports.visible&&t[r].activated?a.classed("hidden",!1):a.classed("hidden",!0)}}},{}],7:[function(t,e,r){e.exports.min=function(t,e){return d3.min(t,e)},e.exports.max=function(t,e){return d3.max(t,e)},e.exports.minMultipleSets=function(t,e,r){for(var a,o=0;o<e.length;o++)if(e[o].activated){var n=d3.min(t,r.raw(e[o]));"undefined"!=typeof n&&("undefined"==typeof a||a>n)&&(a=n)}return a},e.exports.maxMultipleSets=function(t,e,r){for(var a,o=0;o<e.length;o++)if(e[o].activated){var n=d3.max(t,r.raw(e[o]));("undefined"==typeof a||n>a)&&(a=n)}return a},e.exports.applyOverflow=function(t,e,r,a){return"Date"===a?new Date(t.getTime()+(e.getTime()-t.getTime())*r):"Number"===a?t+(e-t)*r:void 0}},{}],8:[function(t,e,r){e.exports=function(t,e){return t.sort(function(t,r){return e.accessor(t)<e.accessor(r)?-1:e.accessor(t)>e.accessor(r)?1:0}),t}},{}],9:[function(t,e,r){function a(t,e){var r=d3.select("#display-overlay").append("div").attr("class","tip-element").attr("style","border-color:"+e.color).attr("data-row",e.rowId);r.append("p").attr("class","tip-title caps").text(e.name?e.name:e.row),r.append("p").attr("class","tip-attribute").attr("data-attribute",t.name?t.name:t.row).text((t.name?t.name:t.row)+": ").append("span"),r.append("p").attr("class","tip-attribute").attr("data-attribute",e.name?e.name:e.row).text("Wert: ").append("span")}function o(t){d3.select('.tip-element[data-row="'+t.rowId+'"]').remove()}var n=t("./line"),i=t("./id"),s=t("./points"),d=t("./domain");e.exports.add=function(t,r,d,l,c,p,u,f,v,m){d3.select("#select-row").append("p").attr("class","select-row-item").classed("inactive",!l.activated).attr("data-row",l.rowId).text(l.name?l.name:l.row),l.activated&&a(r,l),n.setActivated(l.activated,l),l.activated&&s.updateVisibility(d),$('.select-row-item[data-row="'+l.rowId+'"]').on("click",function(){var l=$(this).attr("data-row"),x=i.invert(l,d);$(this).hasClass("inactive")?($(this).toggleClass("inactive",!1),n.setActivated(!0,x),s.updateVisibility(d),a(r,x)):($(this).toggleClass("inactive",!0),n.setActivated(!1,x),o(x)),e.exports.updateYDomain(t,d,c,p,u,f,v,function(){m()})})},e.exports.updateYDomain=function(t,e,r,a,o,n,i,s){a.scale(1),a.translate([0,0]),o=d.overflowY(t,e,r,1.1),n.domain(o),a.y(n),i.scale(n),s()}},{"./domain":1,"./id":4,"./line":5,"./points":6}],10:[function(t,e,r){function a(t,e,r){for(var a=-1,o=0;o<t.length-1;o++){var n,i,s=e.accessor(t[o]),d=e.accessor(t[o+1]),l=r>=s,c=d>=r;l&&c&&(n=Math.abs(e.accessor(t[o])-r),i=Math.abs(e.accessor(t[o+1])-r),a=i>n?o:o+1)}return a}var o=t("./filter");e.exports.opt={},e.exports.tooltip=function(t,e,r,a,o,n,i,s){var d=d3.select('#tooltip[data-row="'+r.rowId+'"]');d.classed("hidden",!s),d.empty()&&(d=d3.select("#graph").append("g").attr("id","tooltip").attr("class","tooltip").attr("data-row",r.rowId),d.append("circle").attr("id","tooltip-circle"));var l,c;if(-1===o)d.attr("visibility","hidden"),l="",c="";else{l=n(t[o]),c=i(t[o])+(r.unit?" "+r.unit:""),d.attr("visibility","visible");var p=a.cord(e,r)(t[o]);d.attr("transform","translate("+p[0]+","+p[1]+")")}d3.select('.tip-element[data-row="'+r.rowId+'"]> .tip-attribute[data-attribute="'+(e.name?e.name:e.row)+'"]> span').text(l),d3.select('.tip-element[data-row="'+r.rowId+'"]> .tip-attribute[data-attribute="'+(r.name?r.name:r.row)+'"]> span').text(c)},e.exports.updateTooltip=function(t,r,o,n,i,s){var d=e.exports.mouse[0]-e.exports.opt.graphTransform.xstart,l=i.invert(d),c=a(t,r,l);e.exports.tooltip(t,r,o,n,c,function(t){if(t=r.accessor(t),t instanceof Date){var e=t.getDate().toString()+"/";return e+=(t.getMonth()+1).toString()+"/",e+=t.getFullYear().toString()}return t.toString()},function(t){var e=(Math.round(1e3*n.raw(o)(t))/1e3).toString();return e},o.activated)},e.exports.updateAll=function(t,r,a,n,i,s){if(e.exports.mouse)for(var d=0;d<a.length;d++)e.exports.updateTooltip(o.row(t,a[d].rowId),r,a[d],n,i,s)}},{"./filter":2}],11:[function(t,e,r){function a(){function t(t){return function(a,n){if(a)return alert(a),void console.log(a);n=T.data_types(n,i[t].config),n=T.ids(n,i[t].config);for(var d=0;d<n.length;d++)r.push(n[d]);++e===i.length&&(r=D(r,s),o(r))}}for(var e=0,r=[],a=0;a<i.length;a++)d3.csv(i[a].url,t(a))}function o(t){function e(){l.call(w),c.call(g);for(var e=0;e<d.length;e++)o.selectAll("circle.data-point[data-row='"+d[e].rowId+"']").attr("cx",s.accessor_scaled).attr("cy",p(d[e]));A.updateAll(t,s,d,u,f,v),k.updateAll(t,s,d,u)}m=N.overflowX(t,s,1.1),x=N.overflowY(t,d,u,1.1),f.domain(m),v.domain(x);var r,a=d3.behavior.zoom().x(f).y(v).scaleExtent([.9,50]).on("zoom",e),o=d3.select("#visualization").attr("width",h).attr("height",y).call(a);o.append("mask").attr("id","mask").append("rect").attr("x",0).attr("y",0).attr("width",h-b.xstart-b.xend).attr("height",y-b.ytop-b.ybottom).attr("fill","white"),r=o.append("g").attr("id","graph").attr("transform","translate("+b.xstart+","+b.ytop+")").attr("mask","url(#mask)");for(var n=0;n<d.length;n++){var i=r.selectAll("circle[data-row='"+d[n].rowId+"']").data(V.row(t,d[n].rowId)).enter();i.append("circle").attr("class","data-point").attr("data-row",d[n].rowId).attr("cx",s.accessor_scaled).attr("cy",p(d[n]))}S.updateVisibility(d);var l=o.append("g").attr("class","axis axis-x").attr("transform","translate("+b.xstart+","+(y-b.ybottom)+")").call(w),c=o.append("g").attr("class","axis axis-y").attr("transform","translate("+b.xstart+",0)").call(g);o.append("rect").attr("id","overlay").attr("x",b.xstart).attr("y",b.ytop).attr("width",h-b.xstart-b.xend).attr("height",y-b.ytop-b.ybottom).on("mousemove",function(){A.mouse=d3.mouse(this),A.updateAll(t,s,d,u,f,v)}),d3.select("#display-overlay").attr("style","left: "+b.xstart+"px;top: "+b.ytop+"px;max-width: "+(h-b.xstart-b.xend)+"px;max-height: "+(y-b.ytop-b.ybottom)+"px;");for(var n=0;n<d.length;n++)k.addLine(V.row(t,d[n].rowId),s,d[n],u);$("select").on("change",function(){k.mode=this.value,k.updateAll(t,s,d,u)}),$("#checkbox-points").on("change",function(){I=$(this).is(":checked")?!0:!1,S.visible=I,S.updateVisibility(d)}),$("#checkbox-lines").on("change",function(){_=$(this).is(":checked")?!0:!1,k.lineVisibility(_,d)});for(var n=0;n<d.length;n++)O.add(t,s,d,d[n],u,a,x,v,g,e)}var n,i,s,d,l,c,p,u,f,v,m,x,w,g,h,y,b,I,_,A=t("./modules/tooltip"),k=t("./modules/line"),D=t("./modules/sort"),S=t("./modules/points"),M=t("./modules/id"),T=t("./modules/format"),V=t("./modules/filter"),N=t("./modules/domain"),O=t("./modules/toggle");I=!1,d3.json("meta.json",function(t,e){if(t)return console.log(t),void alert(t);n=[],i=e.datasets,s={},d=[];for(var r=d3.scale.category20(),o=0;o<i.length;o++)for(var m=i[o],x=m.url,I=0;I<m.config.length;I++){var _=m.config[I];_.url=x,_.rowId=M.get(_),n.push(_),"index"===_.type?s=_:"value"===_.type&&(_.color=r(d.length+1),"undefined"==typeof _.activated&&(_.activated=!0),d.push(_))}"Number"===s.data_type?f=d3.scale.linear():"Date"===s.data_type&&(f=d3.time.scale()),"Number"===d[0].data_type?v=d3.scale.linear():"Date"===d[0].data_type&&(v=d3.time.scale()),h=1100,y=550,b={xstart:70,ytop:0,xend:0,ybottom:50},A.opt.graphTransform=b,f.range([0,h-b.xstart-b.xend]),v.range([y-b.ytop-b.ybottom,0]),w=d3.svg.axis().scale(f).orient("bottom").ticks(5),g=d3.svg.axis().scale(v).orient("left").ticks(5).innerTickSize(-h+b.xstart+b.xend).outerTickSize(2),s.accessor=function(t){return t[s.row]},s.accessor_scaled=function(t){return f(t[s.row])},l=function(t){return function(e){return e[t.rowId]}},p=function(t){return function(e){return v(e[t.rowId])}},c=function(t,e){return function(r){return[t.accessor_scaled(r),p(e)(r)]}},u={raw:l,scaled:p,cord:c},a()})},{"./modules/domain":1,"./modules/filter":2,"./modules/format":3,"./modules/id":4,"./modules/line":5,"./modules/points":6,"./modules/sort":8,"./modules/toggle":9,"./modules/tooltip":10}]},{},[11]);
//# sourceMappingURL=script.js.map
